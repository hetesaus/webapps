<html>	
    <head>
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/uikit/3.0.0-rc.12/css/uikit.min.css" />
    </head>
	<body>
		<div id="app">
			<div class="uk-padding-small">
				<div class="uk-position-center uk-overlay uk-overlay-default uk-text-center">			

					<div class="uk-margin">
						{{ dealer.join(', ') }} ({{ countCards(dealer) }})
					</div>
				
					<div class="uk-margin">
						{{ money }}
					</div>
					
					<div class="uk-margin">
						{{ player.join(', ') }} ({{ countCards(player) }})
					</div>
					
					<div v-if="canControl" class="uk-margin">
						<button @click="hit()">hit</button>
						<button @click="check()">check</button>
					</div>
					
					<div class="uk-margin">
						<button @click="reset()">reset</button>
					</div>
				
				</div>				
			</div>
		</div>
    </body>
</html>

<script src="https://unpkg.com/vue"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/uikit/3.0.0-rc.12/js/uikit.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/uikit/3.0.0-rc.12/js/uikit-icons.min.js"></script>

<script>

	new Vue({
		el: '#app',
		data: {
			money: 1000,
			bet: 10,
			player: [],
			dealer: [],
			canControl: true,
		},
			
		created () {
			this.init ();
		}, 
			
		methods: {
		
			init () {
				this.addCard(this.player, 2);
				this.addCard(this.dealer, 1);
			},
		
			addCard (entity, amount) {
				let number = 0;
				
				for (i = 0; i < amount; i++) {
					number = Math.floor(Math.random() * 14) + 1;
					
					if (number > 10) {
						number = 10;
					}
					entity.push(number);
				}
			},
			
			countCards (entity){
				let total = 0;
		
				for (i = 0; i < entity.length; i++){
					total += entity[i];
				}
				if (entity.includes(1) && total <= 11) {
					return total + 10;
				}
				
				return total;
			},		
		
			hit () {
				this.addCard(this.player, 1);
		
				if (this.countCards(this.player) === 21) {
					this.win();
				}
				if (this.countCards(this.player) > 21) {
					this.lose();
				}
			},
			
			check () { 
				canControl = false;
				this.checkDealerCards(); 
			},
			
			checkDealerCards () {
				while(this.countCards(this.dealer) < 17) {
					this.addCard(this.dealer, 1);
				}
				
				this.checkWinCondition();
			}, 
			
			checkWinCondition () {
				let dealerTotal = this.countCards(this.dealer);
				let playerTotal = this.countCards(this.player);
			
				if (dealerTotal > 21 || dealerTotal <= 21 && playerTotal <= 21 && playerTotal > dealerTotal) {
					this.win();
				} else if (dealerTotal == playerTotal) {
					this.tie();
				} else {
					this.lose();
				}
			},
		
			win () {	
				this.money += this.bet;
			},
			
			tie () {

			},
			
			lose () {
				this.money -= this.bet;
			},
			
			reset () {
				this.player = [];
				this.dealer = [];
				
				this.init();
				
				this.canControl = true;
			}
		}
	})

</script>
